"""
 *  Treating genus 3 curves by cheating
 *
 *  Copyright (C) 2016  J.R. Sijsling (sijsling@gmail.com)
 *
 *  Distributed under the terms of the GNU General License (GPL)
 *                  http://www.gnu.org/licenses/
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License along
 *  with this program; if not, write to the Free Software Foundation, Inc., 51
 *  Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
"""

# Add if no initilization script set:
load('Initialize.sage')

# To obtain the following matrices, use this Maple code:
#Digits := 100:
#with(algcurves):
#f := y^3 - x^4 - 2*x^2 - 3:
#f := y^3 - x^4 + 3*x^2 - 7:
#f := y^3 - x^4 - x - 1:
#f := x*(y^3 + 1^3) + y^2*1^2 + 3*x^2*y*1 + 5*x^4:
#f := x^4 + (y^3 + 5*y*1^2 + 5*1^3)*1:
#f := x^4 + (y^3 - 2*y*1^2 - 2*1^3)*1:
#f := x^4 + 8*x^3*1 + 2*x^2*y*1 + 25*x^2*1^2 - x*y^3 + 2*x*y^2*1 + 8*x*y*1^2 + 36*x*1^3 + y^4 - 2*y^3*1 + 5*y^2*1^2 + 9*y*1^3 + 20*1^4:
#pm := periodmatrix(f,x,y):
#evalf(pm, 100);

prec = 100
CC = magma.ComplexField(prec)
I = CC.1

P = magma.Matrix(
[
[0.728694434169745575964626271204824394144407860716418591217404023949214363920429701089816824337034227 +
0.4207119277248846391177365052085744887419230376135291340785154813394569284752849289621313933200365540*I ,
0.943509711152646498776100249954881784679712760742142458204946130762671581362368856909554031046823880,
1.200449289746068825352676396182265286484264241087489820319877089330550154601614129544593839860446165 +
0.3963914508506251205263880675812536168057170048146854545739441542550113081980866339426248083030404050*I ,
-0.943509711152646498776100249954881784679712760742142458204946130762671581362368856909554031046823874 ,
-0.471754855576323249388050124977440892339856380371071229102473065381335790681184428454777015523411940 +
0.0243204768742595185913484376273208719362060327988436795045713270844456202771982950195065850169961505*I ,
-0.256939578593422326576576146227383501804551480345347362114930958567878573239245272635039808813622290 +
0.3963914508506251205263880675812536168057170048146854545739441542550113081980866339426248083030404045*I]
,
[0.599906420394872144249917224029294704708775952158474260773883727081295493711206399096044017344448923 -
0.346356133303564232304620946916099093096101464140477858699739325258212503150713171634061202269302932*I ,
-1.068676230752773916695426894800647945419166475513397380476051885265774318678322660215734738931582846 ,
0.065568305018485185902203776628970731999192714401775570535857784448408334372045068988176647878657498 +
1.271856897556067193158928783158351286939806773835367330206022451082303353748817161214288191818272160*I ,
1.068676230752773916695426894800647945419166475513397380476051885265774318678322660215734738931582854 ,
0.534338115376386958347713447400323972709583237756698690238025942632887159339161330107867369465791417 -
1.618213030859631425463549730074450380035908237975845188905761776340515856899530332848349394087575094*I ,
-1.134244535771259102597630671429618677418359189915172951011909669714182653050367729203911386810240347 +
1.271856897556067193158928783158351286939806773835367330206022451082303353748817161214288191818272160*I]
,
[0.540920437253437752368050706424339632125595727726114814934399557621092549399925123379079934774318739 -
0.936901680175327076871766916265421103901563402766074668666537267927540666828938620707143571936161056*I ,
1.081840874506875504736101412848679264251191455452229629868799115242185098799850246758159869548637472 ,
0 ,
1.081840874506875504736101412848679264251191455452229629868799115242185098799850246758159869548637480 ,
-0.540920437253437752368050706424339632125595727726114814934399557621092549399925123379079934774318736 +
0.936901680175327076871766916265421103901563402766074668666537267927540666828938620707143571936161074*I ,
-1.081840874506875504736101412848679264251191455452229629868799115242185098799850246758159869548637479]
])

P = magma.Matrix(
[
[0.571283485372965535027605404088806275766493339214533022894202266223388290800945656089553781165427910 +
0.3298306740636692846412166069003576909562019736500621566416824317924699705900509305316544142519532210*I ,
0.589776300625371350580998068780459760652191214220856379419604178588257530701078246863945000398452160 ,
0.866171635685651210318104438479036156092588946324961212604004355517517056151484779521526281364653997 +
0.1809305848279104144262276116029566373783050933002308457258135065119159111450577639454401282190665505*I ,
-0.589776300625371350580998068780459760652191214220856379419604178588257530701078246863945000398452178 ,
-0.294888150312685675290499034390229880326095607110428189709802089294128765350539123431972500199226076 +
0.1489000892357588702149889952974010535778968803498313109158689252805540594449931665862142860328866735*I ,
-0.276395335060279859737106369698576395440397732104104833184400176929259525450406532657581280966201823 +
0.1809305848279104144262276116029566373783050933002308457258135065119159111450577639454401282190665515*I]
,
[0.858466352698431286347390653226472837363579564253306271680436851162820645848795766812512827003469933 -
0.495635779820675517486502611941886116114770760709822357784823851152501113934969750845761422696547217*I ,
-0.648894247690791405083801905924100248017798627222223102740358000421228424142186352420926665071522920 ,
0.534019228853035583805489700264422713354680250642194720310257850952206433777702590602049494467708472 +
1.057594682690492689014467015094100554464312150328647545131730366477226507894255125590568937412738976*I ,
0.648894247690791405083801905924100248017798627222223102740358000421228424142186352420926665071522928 ,
0.324447123845395702541900952962050124008899313611111551370179000210614212071093176210463332535761458 -
1.553230462511168206500969627035986670579082911038469902916554217629727621829224876436330360109286205*I ,
-1.182913476543826988889291606188522961372478877864417823050615851373434857919888943022976159539231396 +
1.057594682690492689014467015094100554464312150328647545131730366477226507894255125590568937412738982*I]
,
[0.468298523071060763295938869392756684989327013220241792939723574248147201970240835302473736451151658 -
0.811116835068543309780332334943133642994928075581608341982404243450478421718028064476286215036897679*I ,
0.936597046142121526591877738785513369978654026440483585879447148496294403940481670604947472902303316 ,
0 ,
0.936597046142121526591877738785513369978654026440483585879447148496294403940481670604947472902303315 ,
-0.468298523071060763295938869392756684989327013220241792939723574248147201970240835302473736451151655 +
0.811116835068543309780332334943133642994928075581608341982404243450478421718028064476286215036897667*I ,
-0.936597046142121526591877738785513369978654026440483585879447148496294403940481670604947472902303317 ]
])

P = magma.Matrix(
[
[1.060409906404544878113754459920602779881560972883638581488497831332681253274167337850515310156396303 +
0.854276481472885988366196307822367880439681459644991302506181848394296987507460968619783401976678570*I ,
1.079821631462513489050072723002175694155720552895085151205405754258642368432365873889080691402676974 ,
1.809940903744634792318467574076852646642236921412699752948149222590977046003620477879527473444241563 +
0.443949287767922766166395737917105447179309806858559299812678924949775702577249072148135799646271520*I ,
-1.499061994680179828409426228312499733521351897058122342919302782516591585458906280058024326575690536 ,
-0.539910815731256744525036361501087847077860276447542575602702877129321184216182936944540345701338477 +
0.047254388866649010745383722618389870131082975870458629777545605717310580157260065574558818193861640*I ,
-0.310878909064454963909041345764352913120885024354577410028846440074385460544714197821503146868551040 +
0.443949287767922766166395737917105447179309806858559299812678924949775702577249072148135799646271510*I]
,
[0.802002982878253423177296194572447188375457345115995729232612080617532201369538827635494665106390618 -
0.609506624027450963630673945748585191971289133090022280948779036307557539451593536147600951136350218*I ,
-1.030271608955592435447950393549693704682260731398685933402785868288989308425062919601392894791307424 ,
0.4137139071439937490512846797788990917332050217199937384922957018065912500012962387016468557906623640 +
1.282043031223148388258168492856642049837740610818514939746765274724579355849769583456811535742098704*I ,
0.7765781514685193482520230295870961932845046467920039814806327576218819027364851778676956186314565300 ,
0.5151358044777962177239751967748468523411303656993429667013929341444946542125314598006964473956537020 -
1.671844676292886561775565556496475181145880349058855106128517265599179349455833775716331406945988588*I ,
-1.190292058612513097303307709365995285017709668511997719972928459428473152737781416569342474422118878 +
1.282043031223148388258168492856642049837740610818514939746765274724579355849769583456811535742098704*I]
,
[0.531402512724810700783644398384616622218792977940370928152126959085990313706197007222908735303845000 -
1.108494870324286439047562911922098593933143729399629789063944402627953204134785517644438248741169955*I ,
1.252191723528367294501753904353118895688164379005398797443959071021716793885890753985964108529777190 ,
-0.068187599538980122442613507886381824968205878605278579217024913777665311153822931524628787483651700 +
0.069974332167473746508885525223458482761408423334145105839994536706452089842144122940190395489045730*I ,
1.199180224527581646452515812541996894373997713091299014738303745727311249720039877495075045574993400 ,
-0.626095861764183647250876952176559447844082189502699398721979535510858396942945376992982054264888595 +
0.944481178649238956228456675350624070147544457597582306259832117048457765932502276876221726298711559*I ,
-1.130992624988601524009902304655615069405791834486020435521278831949645938566216945970446258091341700 +
0.069974332167473746508885525223458482761408423334145105839994536706452089842144122940190395489045730*I]
]);

P = magma.Matrix(
[
[0.9127111546232825913056597571475847102013812112074974396981661769836256371203658265712526210334069011 -
1.580862092442379044674422760708538161947868177253151397998507599681863533655177978078901474002355095*I ,
0.912711154623282591305659757147584710201381211207497439698166176983625637120365826571252621033406919 -
1.580862092442379044674422760708538161947868177253151397998507599681863533655177978078901474002355095*I ,
0.1694043450296767624413387130510010794577393811895283127591807488429259825246958349485363087470634271,
0.9974133271381209725263291136730852499302509018022615960777565514050886283827137440455207754069385971 -
0.5758568529165144083327976254701897559763184664995679543165493025403741144978229974605688834065528770*I ,
-0.0847021725148383812206693565255005397288696905947641563795903744214629912623479174742681543735316962 +
2.156718945358893453007220386178727917924186643752719352315056902222237648153000975539470357408907972*I ,
0.084702172514838381220669356525500539728869690594764156379590374421462991262347917474268154373531696 -
0.1467084663071641803239701157020311059810872222455524649511403079392588098382910143028051762173035340*I],
[-0.08470217251483838122066935652550053972886969059476415637959037442146299126234791747426815437353170141 -
0.146708466307164180323970115702031105981087222245552464951140307939258809838291014302805176217303528*I ,
-0.0847021725148383812206693565255005397288696905947641563795903744214629912623479174742681543735317138 -
0.1467084663071641803239701157020311059810872222455524649511403079392588098382910143028051762173035300*I ,
-1.825422309246565182611319514295169420402762422414994879396332353967251274240731653142505242066813822,
-0.9974133271381209725263291136730852499302509018022615960777565514050886283827137440455207754069386138 -
0.575856852916514408332797625470189755976318466499567954316549302540374114497822997460568883406552875*I ,
0.9127111546232825913056597571475847102013812112074974396981661769836256371203658265712526210334069124 +
0.722565319223678588656767741172220861957405688745120419267689610479632924336114011763374059623856403*I ,
-0.9127111546232825913056597571475847102013812112074974396981661769836256371203658265712526210334069124 -
1.580862092442379044674422760708538161947868177253151397998507599681863533655177978078901474002355101*I],
[-0.9614160143077875945677077348961209452509980667789325061799390790537040065425093341248788761426150163,
0.480708007153893797283853867448060472625499033389466253089969539526852003271254667062439438071307506,
0.4807080071538937972838538674480604726254990333894662530899695395268520032712546670624394380713075037,
-1.442124021461681391851561602344181417876497100168398759269908618580556009813764001187318314213922527 -
0.5039564034670010952853114093174582882596800059769208619863313503051715519862562160094440848074827932*I ,
0.4807080071538937972838538674480604726254990333894662530899695395268520032712546670624394380713075099 +
0.5039564034670010952853114093174582882596800059769208619863313503051715519862562160094440848074828024*I ,
-0.4807080071538937972838538674480604726254990333894662530899695395268520032712546670624394380713075103]
]);

P = magma.Matrix(
[
[-0.992257024060755742148143527203726143571285992857326114919506966597253689425277029294715683042375392 +
0.1883372741384976512527852905264932067265229899371827358090799677100443625259161243299627257695151000*I ,
-0.8039197499222580908953582366772329368447630029201433791104269988872093268993609049647529572728602920 -
0.8039197499222580908953582366772329368447630029201433791104269988872093268993609049647529572728602900*I ,
0.565011822415492953758355871579479620179568969811548207427239903130133087577748372989888177308545292 -
0.9922570240607557421481435272037261435712859928573261149195069665972536894252770292947156830423754000*I ,
0.188337274138497651252785290526493206726522989937182735809079967710044362525916124329962725769515098 -
0.6155824757837604396425729461507397301182400129829606433013470311771649643734447806347902315033452000*I ,
0.615582475783760439642572946150739730118240012982960643301347031177164964373444780634790231503345196 -
0.1883372741384976512527852905264932067265229899371827358090799677100443625259161243299627257695151000*I ,
0.565011822415492953758355871579479620179568969811548207427239903130133087577748372989888177308545298 -
0.6155824757837604396425729461507397301182400129829606433013470311771649643734447806347902315033451970*I],
[-0.0820249223508866011663995430745502762986844685880923872990528661842093106509444223153451266500850809 +
0.8452512798231405599067245376724661531622550615600280034770038880609925367954611175058812150782633390*I ,
0.7632263574722539587403249945979158768635705929719356161779510218767832261445166951905360884281782681 +
0.763226357472253958740324994597915876863570592971935616177951021876783226144516695190536088428178270*I ,
2.535753839469421679720173613017398459486765184680084010431011664182977610386383352517643645234790030 -
0.082024922350886601166399543074550276298684468588092387299052866184209310650944422315345126650085069*I ,
0.845251279823140559906724537672466153162255061560028003477003888060992536795461117505881215078263349 +
1.608477637295394518647049532270382030025825654531963619654954909937775762939977812696417303506441609*I ,
-1.608477637295394518647049532270382030025825654531963619654954909937775762939977812696417303506441617 -
0.8452512798231405599067245376724661531622550615600280034770038880609925367954611175058812150782633390*I ,
2.535753839469421679720173613017398459486765184680084010431011664182977610386383352517643645234790047 +
1.608477637295394518647049532270382030025825654531963619654954909937775762939977812696417303506441613*I],
[1.094544726537995673394296670066463671643614330404349355708114426587251548505314166543688026977152773 +
0.4777610774667593008856312135142269834880489049912086220639608761442212197399608883924214666493853580*I ,
-0.9555221549335186017712624270284539669760978099824172441279217522884424394799217767848429332987707302*I ,
-1.094544726537995673394296670066463671643614330404349355708114426587251548505314166543688026977152796 -
0.4777610774667593008856312135142269834880489049912086220639608761442212197399608883924214666493853581*I ,
-1.094544726537995673394296670066463671643614330404349355708114426587251548505314166543688026977152776 +
1.433283232400277902656893640542680950464146714973625866191882628432663659219882665177264399948156078*I ,
1.094544726537995673394296670066463671643614330404349355708114426587251548505314166543688026977152779 -
0.4777610774667593008856312135142269834880489049912086220639608761442212197399608883924214666493853580*I ,
-1.094544726537995673394296670066463671643614330404349355708114426587251548505314166543688026977152780 +
0.4777610774667593008856312135142269834880489049912086220639608761442212197399608883924214666493853690*I]
]);

P = magma.Matrix(
[
[-0.709405978948882417234094721439074016050485919299713347547776304110103967580287564105482610071750744 +
1.169996081013777801655761441037447933223924870557277901581121009335540645594339598982252112510221578*I ,
-0.2184818094134879958287533260830886451837304288991843035100312374418111819792939385123159355838819400 -
0.9382640081087230752955574706108798519148236069477509333346567037070036445088087581018469977631811578*I ,
0.666132977090991180915258233279987136394476005467897191224309534707545279082931685501471980319142316 -
1.355830774872619095562773974981725372709109305465450831258712246041713718531246911533957674109547782*I ,
-0.884614786504479176744011559363075781578206434367081494734340772149356461062225624013787915903024243 -
0.4175667667638960202672165043708455207942856985176998979240555423347100740224381534321106763463666241*I ,
1.933750831714027919568941701619432127840848665031186855961030189955853682461339437971356964069825549 -
0.3348625474859857611213284322957568916353534735218781057330099246661204975494632921180307598174883298*I ,
-0.3936906169690847553386701640070904107114509439665524506965957054810636754612319984206212414151554870 +
1.690693322358604856684102407277482264344462778987328936991722170707834216080710203651988433927036112*I]
,
[0.1795490112102236658891670102970032576924189560471400447281208243283284682162929753363539167972469600 +
0.898241090325715249671754499123739389866462781999085706543715020968094592907930709003761239178333608*I ,
0.906528115993383043368717631588359400908854842640131960979194775986521222614775734420015896324744279 +
0.498486197651282600767879590549712453624454567525277197440380769621074139540712718404425950655295940*I ,
1.230064254719530997139988690966936453077211024669368870979886220753001063726123079321926972282992929 -
0.1231159235545407363813184059791072085224357707694861456342233975011596208001890838989900413696015362*I ,
-0.3235361387261479537712710593785770521683561820292369100006914447664798411113473449019110759582486480 -
0.621602121205823337149197996528819662146890338294763343074604167122233760340901802303415992024897472*I ,
-2.799491175311012600043161397299280241606288050454913979187275390084796740020115272539887516585232862 +
0.344963152085931424626641493933899934427317894590440979605493313276372927773872895603070744871461336*I ,
0.403442966057011423708279561912779091048079704563755006250382506891712913287135414181750903569248673 -
0.221847228531390688245323087954792725904882123820954833971269915775213306973683811704080703501859804*I]
,
[2.825716293400112291152429235451985131512171153471493486365880450597625696108686474551817567236502259 -
2.138033461992526862846206302122719093419639982798829398447787835096246615922273231385229239342765338*I ,
1.341749610468900937462010640892619372215704605510680187717003042825543156755647684557190240261007335 +
2.330325095989449830903074600520247999798635364385368759529817717853923268046893343693166224510904949*I ,
0.198651370906283106471899210581364619823979354045364941762808157322665074129856498424082345910206776 +
3.983172711956453748211193377989223442357960618279592426869335511482774634102928868769324713533492606*I ,
1.143098239562617830990111430311254752391725251465315245954194885502878082625791186133107894350800461 +
1.652847615967003917308118777468975442559325253894223667339517793628851366056035525076158489022587668*I ,
-4.827478627600727120675836188741001862134097771501857756410521491710303096165486635943159182509128021 -
1.167661769941480971770031252815231791699010524989617936231247752161456116189797818767087738702409988*I ,
-0.340868443368593522700307164248111006904741296495498052694682522269204456727247603861519432624694435 -
2.815510942014972776441162125173991650658950093289974490638087759321318517913131050002236974831082619*I]
]);

g = 0
End = EndomorphismData(g, prec = prec)
End._P_ = magma.Transpose(P)

AsAlg, As, Rs = End.geometric_representations()

print As
print Rs
print magma.SplittingInfoOneOff(Rs)

#print AsAlg
#print magma.SplittingInfoOneOff(Rs)
#
#dim = len(AsAlg)
#B = 1
#D = [-B..B]
#CP = cartesian_product([ D for i in range(dim) ])
#deg_min = 10^6
#for tup in CP:
#    print tup
#    R = sum([ tup[i]*Rs[i+1] for i in range(dim) ])
#    A = sum([ tup[i]*AsAlg[i+1] for i in range(dim) ])
#    p = magma.MinimalPolynomial(R)
#    deg = End.degree_estimate(A)
#    if magma.Degree(p) == dim:
#        if deg < deg_min:
#            deg_min = deg
#            R_min = R
#            A_min = A
#print deg_min
#print R_min
#print A_min

#[   -r^2 + r + 1               0 2*r^2 - 4*r - 2]
#[              0         r^2 - 2               0]
#[              0               0              -r]
#Number Field with defining polynomial x^3 - x^2 - 2*x + 1 over the Rational Field

