"""
 *  The irreplaceable debug file
 *
 *  Copyright (C) 2016  J.R. Sijsling (sijsling@gmail.com)
 *
 *  Distributed under the terms of the GNU General License (GPL)
 *                  http://www.gnu.org/licenses/
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License along
 *  with this program; if not, write to the Free Software Foundation, Inc., 51
 *  Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
"""

# Add if no initilization script set:
load('Initialize.sage')

# Ambient ring:
R.<x> = PolynomialRing(QQ)

# A whole list of bugs due to Drew:
bug_list = [
'55527906308456448:186624:69382059420903874:[24*x^6+30*x^3-1,1]:1:1,1:J(D_3)',
'2821109907456:186624:1681142508473529346:[-24*x^6+6*x^3-1,1]:1:1,1:J(D_3)',
'11664000000:291600:158035535341229379:[-11*x^3+125,x^3]:0:1,1,1+5*x^2:J(D_3)',
'111236572265625:455625:203784485673143427:[6*x^6+27*x^3+31,x^3+1]:1:1,1:J(D_3)',
'55527906308456448:746496:702205648556161247:[3*x^6+30*x^3-6,0]:0:1,1:J(D_3)',
'2821109907456:746496:966735162781544050:[3*x^6+6*x^3+6,0]:0:1,1:J(D_3)',
'113906250000000000:810000:1230885881436163497:[25*x^6+55*x^3+31,1]:1:1,1,1:J(D_3)',
'9183300480000000000:1440000:896867595559853537:[25*x^6+50*x^3-2,0]:1:1,1+2*x+3*x^2,1:J(D_3)',
'1313681671142578125:1476225:2094222623306943375:[2*x^6+37*x^3+31,x^3+1]:0:1,1+5*x^2:J(D_3)',
'739537035580145664:1679616:1337629213994386305:[-4*x^6+18*x^5-30*x^4+40*x^3+24*x+8,0]:1:1,1:J(D_3)',
'162679413013056:3779136:208406992219975257:[-54*x^6+9*x^3-1,1]:0:1+2*x^2,1:J(D_3)',
'3202018886335981248:3779136:1825451201360130567:[54*x^6+45*x^3-1,1]:0:1+2*x^2,1:J(D_3)',
'9183300480000000000:5760000:1392708414857551019:[2*x^6+50*x^3-25,0]:0:1,1-2*x+3*x^2,1:J(D_3)',
'11664000000:7290000:797509416137634325:[25*x^6+11*x^3+1,1]:1:1,1,1:J(D_3)',
'116640000000000:7290000:930641393311780470:[-x^6-15*x^4-20*x^3-30*x^2-18*x-5,0]:0:1,1,1:J(D_3)',
'12230590464000000:12960000:523822097492275922:[-20*x^6+44*x^3-25,0]:1:1,1,1:J(D_3)',
'466560000000000:12960000:677145827631175884:[-10*x^3+200,x^3]:1:1,1,1:J(D_3)',
'55527906308456448:15116544:140123135254532098:[-8*x^6+30*x^3+2,1]:1:1,1:J(D_3)',
'166583718925369344:15116544:1320640992831967246:[-6*x^6+18*x^3-27,0]:1:1,1:J(D_3)',
'166583718925369344:15116544:1627233491596575227:[-24*x^6+18*x^3-7,1]:1:1,1:J(D_3)',
'55527906308456448:15116544:2133276408462421226:[-30*x^3-72,x^3]:1:1,1:J(D_3)',
'688747536000000:23619600:55938652608820807:[9*x^6+33*x^3+31,1]:0:1,1,1+5*x^2:J(D_3)',
'705277476864000000:23619600:785587350520669737:[36*x^6+66*x^3+31,1]:2:1,1,1+5*x^2:J(D_3)',
'722204136308736:26873856:1486370947019648033:[-2*x^6+9*x^5-15*x^4+20*x^3+12*x+4,0]:1:1,1:J(D_3)',
'4449462890625000000:29160000:252688170048826698:[10*x^6+25*x^3+31,1]:0:1+2*x^2,1,1:J(D_3)',
'8968066875000000:29160000:373674197008328340:[25*x^3-50,x^3]:0:1+2*x^2,1,1:J(D_3)',
'26904200625000000:29160000:929345457590776878:[-6*x^6+15*x^3-19,1]:0:1+2*x^2,1,1:J(D_3)',
'1313681671142578125:36905625:272826960636930343:[6*x^6+37*x^3+11,x^3+1]:1:1,1:J(D_3)',
'1313681671142578125:36905625:2228533545697895750:[x^6+37*x^3+56,x^3+1]:1:1,1:J(D_3)',
'12824703626379264:47775744:977154876292736837:[-x^6-6*x^5-30*x^4-40*x^3-60*x^2-24*x-8,0]:0:1,1:J(D_3)',
'12824703626379264:47775744:1180271971405198248:[x^6+6*x^5+30*x^4+40*x^3+60*x^2+24*x+8,0]:2:1,1:J(D_3)',
'466560000000000:51840000:2093689179061307110:[-2*x^6+10*x^3-25,0]:0:1,1,1:J(D_3)',
'55527906308456448:60466176:208695318052113922:[2*x^6+30*x^3-9,0]:0:1,1:J(D_3)',
'55527906308456448:60466176:341218593193816082:[-x^6+30*x^3+18,0]:0:1,1:J(D_3)',
'166583718925369344:60466176:367176290007110635:[3*x^6+18*x^3+54,0]:0:1,1:J(D_3)',
'166583718925369344:60466176:811617535755616316:[6*x^6+18*x^3+27,0]:2:1,1:J(D_3)',
'170581728179578208256:60466176:2027933018129256329:[24*x^6+36*x^3+27,0]:0:1,1:J(D_3)',
'56860576059859402752:60466176:2280197823219476003:[8*x^6+60*x^3-9,0]:0:1,1:J(D_3)',
'233994140164030464:107495424:278813079433169379:[-4*x^6+9*x^5-30*x^4+40*x^3-12*x+8,0]:2:1,1:J(D_3)',
'116640000000000:116640000:239670527837677959:[x^6+15*x^4+20*x^3+30*x^2+18*x+5,0]:2:1,1,1:J(D_3)',
'144440827261747200000:116640000:699838180021172540:[3*x^6+60*x^3+60,0]:1:1,1,1:J(D_3)',
'9183300480000000000:116640000:788961599193742768:[5*x^6+50*x^3-10,0]:1:1,1,1:J(D_3)',
'27549901440000000000:116640000:1101199267154487537:[-15*x^6+30*x^3-30,0]:1:1,1,1:J(D_3)',
'4556250000000000000000:116640000:1518577805547019857:[40*x^6+50*x^3+31,1]:1:1,1,1:J(D_3)',
'9183300480000000000:116640000:1694160239175454877:[-8*x^6+50*x^3+6,1]:1:1,1,1:J(D_3)',
'11943936000000:116640000:1822652136793707985:[-5*x^6+22*x^3-25,0]:1:1,1,1:J(D_3)',
'27549901440000000000:116640000:1850456900868941588:[-24*x^6+30*x^3-19,1]:1:1,1,1:J(D_3)',
'2504824927027200000:207360000:1458600837015089674:[-8*x^6+40*x^3-10,0]:1:1,1,1:J(D_3)',
'2504824927027200000:207360000:1853333106239784760:[8*x^6+40*x^3+10,0]:1:1,1,1:J(D_3)',
'477757440000000000:466560000:320121783265911367:[-8*x^6+20*x^3-25,0]:0:1,1,1:J(D_3)',
'27549901440000000000:466560000:416674387111480714:[15*x^6+30*x^3+30,0]:0:1,1,1:J(D_3)',
'9183300480000000000:466560000:688192311081863309:[-x^6+50*x^3+50,0]:0:1,1,1:J(D_3)',
'466560000000000:466560000:717108265236543806:[-x^6+10*x^3-50,0]:0:1,1,1:J(D_3)',
'9183300480000000000:466560000:1909970503741155627:[10*x^6+50*x^3-5,0]:2:1,1,1:J(D_3)',
'137749507200000:590490000:498425042311251788:[15*x^3+45,x^3]:1:1,1,1:J(D_3)',
'137749507200000:590490000:2013167213122837951:[5*x^6+15*x^3+2,1]:1:1,1,1:J(D_3)',
'137749507200000:590490000:2083052797605158047:[9*x^6+15*x^3+1,1]:1:1,1,1:J(D_3)',
'137749507200000:590490000:2275823891838964544:[x^6+15*x^3+11,1]:1:1,1,1:J(D_3)',
'2504824927027200000:1866240000:96340206308420217:[-2*x^6+40*x^3-40,0]:1:1,1,1:J(D_3)',
'12230590464000000:1866240000:122551336333132964:[10*x^6+44*x^3+50,0]:1:1,1,1:J(D_3)',
'2504824927027200000:1866240000:521533782681830211:[2*x^6+40*x^3+40,0]:1:1,1,1:J(D_3)',
'12230590464000000:1866240000:609119354134467549:[-10*x^6+44*x^3-50,0]:1:1,1,1:J(D_3)',
'119439360000000000:1866240000:1099122623371729509:[2*x^6+30*x^4+40*x^3+60*x^2+36*x+10,0]:0:1,1,1:J(D_3)',
'119439360000000000:1866240000:1270342441256937494:[-2*x^6-30*x^4-40*x^3-60*x^2-36*x-10,0]:0:1,1,1:J(D_3)',
'26904200625000000:2361960000:164365058184782744:[15*x^3+450,x^3]:2:1+2*x^2,1,1:J(D_3)',
'1588666142705625000000:2361960000:745790542857714086:[-54*x^6+45*x^3-19,1]:0:1+2*x^2,1,1:J(D_3)',
'1588666142705625000000:2361960000:2151868670773328746:[-30*x^6+45*x^3-34,1]:2:1+2*x^2,1,1:J(D_3)',
'27549901440000000000:9447840000:116894135336036455:[18*x^6+30*x^3+25,0]:1:1,1,1:J(D_3)',
'27549901440000000000:9447840000:771328093953663168:[40*x^6+30*x^3+11,1]:1:1,1,1:J(D_3)',
'27549901440000000000:9447840000:927682539109500773:[8*x^6+30*x^3+56,1]:1:1,1,1:J(D_3)',
'27549901440000000000:9447840000:1093366106028805941:[10*x^6+30*x^3+45,0]:1:1,1,1:J(D_3)',
'28211099074560000000000:9447840000:1095994083412082178:[32*x^6+60*x^3+56,1]:1:1,1,1:J(D_3)',
'141055495372800000:9447840000:1255766034723509652:[-5*x^6+30*x^3-9,0]:1:1,1,1:J(D_3)',
'144440827261747200000:9447840000:1327569893963772085:[-5*x^6+60*x^3-36,0]:1:1,1,1:J(D_3)',
'141055495372800000:9447840000:1410146935429192647:[-x^6+30*x^3-45,0]:1:1,1,1:J(D_3)',
'144440827261747200000:9447840000:1813936816293336020:[-4*x^6+60*x^3-45,0]:1:1,1,1:J(D_3)',
'144440827261747200000:9447840000:1995216028549452341:[-9*x^6+60*x^3-20,0]:1:1,1,1:J(D_3)',
'27549901440000000000:9447840000:2286859216873355054:[9*x^6+30*x^3+50,0]:1:1,1,1:J(D_3)',
'27549901440000000000:37791360000:682952483129769270:[-9*x^6+30*x^3-50,0]:0:1,1,1:J(D_3)',
'28211099074560000000000:37791360000:1959409282273639640:[-40*x^6+60*x^3-45,0]:2:1,1,1:J(D_3)',
'27549901440000000000:37791360000:2195895552009245486:[-18*x^6+30*x^3-25,0]:2:1,1,1:J(D_3)',
'27549901440000000000:37791360000:2257699241559186949:[-10*x^6+30*x^3-45,0]:0:1,1,1:J(D_3)',
'144440827261747200000:151165440000:1040003033790817284:[10*x^6+60*x^3+18,0]:1:1,1,1:J(D_3)',
'144440827261747200000:151165440000:1220180944964744005:[-10*x^6+60*x^3-18,0]:1:1,1,1:J(D_3)',
'21474836480000000000:655360000:768817063176480154:[-7*x^6+2*x^5-30*x^4+40*x^3+20*x^2-8*x+8,0]:1:1,1:O_1',
'20480000000000:655360000:1277541155245982401:[x^6+x^5-10*x^4+20*x^3-10*x^2+6*x-4,0]:3:1,1:O_1',
'21474836480000000000:655360000:1604487720534584780:[7*x^6-2*x^5+30*x^4-40*x^3-20*x^2+8*x-8,0]:1:1,1:O_1',
'20480000000000:655360000:1614360761660194955:[-x^6+x^5+10*x^4+20*x^3+10*x^2+6*x+4,0]:1:1,1:O_1',
'7312316880125952:6879707136:1281469314803945198:[-x^6-3*x^5-20*x^3-30*x^2-18*x+8,0]:1:1,1:O_1',
'7312316880125952:6879707136:1367440788824999380:[x^6+3*x^5+20*x^3+30*x^2+18*x-8,0]:3:1,1:O_1',
'1209323520000000000:53084160000:1709760502661643869:[3*x^6+3*x^5-30*x^4+60*x^3-30*x^2+18*x-12,0]:1:1,1,1:O_1',
'1209323520000000000:53084160000:2262297518022999644:[12*x^6+18*x^5+30*x^4+60*x^3+30*x^2+3*x-3,0]:1:1,1,1:O_1',
]

while True:
    bug_line = bug_list.pop(0)
    bug_line_split = bug_line.split(':')
    bug_pols = eval(bug_line_split[3].replace('^', '**'))
    print bug_pols
    f = bug_pols[0]
    h = bug_pols[1]

    End = EndomorphismData(f, h, prec = 300)
    #print End.over_base().description()
    Lat = End.lattice()
    # Just for Sato-Tate:
    print End._lat_.pop().pop()
