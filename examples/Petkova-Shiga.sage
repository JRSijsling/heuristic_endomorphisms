"""
 *  Some examples of endomorphism rings
 *
 *  Copyright (C) 2016-2017
 *            Edgar Costa      (edgarcosta@math.dartmouth.edu)
 *            Davide Lombardo  (davide.lombardo@math.u-psud.fr)
 *            Jeroen Sijsling  (jeroen.sijsling@uni-ulm.de)
 *
 *  See LICENSE.txt for license details.
"""

load("../Initialize.sage")

prec = 80
CC = magma.ComplexFieldExtra(prec)
I = CC.1

P = magma.Matrix(CC, [
    [1.134803188672312495958997095518625121773662233708117045195687474471598448204389367801693974966143368 +
    0.655178926457205294613395448383109293820699555666687171973623387273581675781031842354884854550813697*I ,
    1.443035550619606019725504093506357954719691587853018502632683227023212735171150749674848294985999088,
    1.856320963982115505821749142271804099133508027634626296512029087983204815789964742639118122459142907 +
    0.594526518943438762880598076969222413388186637007333140499906336219622825272632576680173553558894955*I ,
    -1.443035550619606019725504093506357954719691587853018502632683227023212735171150749674848294985999078,
    -0.721517775309803009862752046753178977359845793926509251316341613511606367585575374837424147492999544 +
    0.060652407513766531732797371413886880432512918659354031473717051053958850508399265674711300991918745*I ,
    -0.413285413362509486096245048765446144413816439781607793879345860959992080618813992964269827473143829 +
    0.5945265189434387628805980769692224133881866370073331404999063362196228252726325766801735535588949550*I],
    [0.682319183976174766324958975409193568786879222162546696709634338430359490641519124284164506267360778 -
    0.393937164541890287829467884162914242862166776378667309925264812857841626510252321453473129270790009*I ,
    -1.133386679254062992090179826170562559719344135648094849153688120753667339237093083106513452386485462,
    0.115625844349143270279869062323912288927207154338499272132790278053525821022972582730907780074118047 +
    1.375478821086794242875838812347729067491252804872217620264038334810437083354594246707149689540001727*I ,
    1.133386679254062992090179826170562559719344135648094849153688120753667339237093083106513452386485462,
    0.566693339627031496045089913085281279859672067824047424576844060376833669618546541553256726193242733 -
    1.769415985628684530705306696510643310353419581250884930189303147668278709864846568160622818810791736*I ,
    -1.249012523603206262370048888494474848646551289986594121286478398807193160260065665837421232460603510 +
    1.375478821086794242875838812347729067491252804872217620264038334810437083354594246707149689540001727*I],
    [0.636983494621901784641039487225435548918801822776654682337034601298411045488944956681897546438373876 -
    1.103287776267910592404414808764092976528379922937855445400071134013121572428383162131545363935886701*I ,
    1.273966989243803569282078974450871097837603645553309364674069202596822090977889913363795092876747742,
    0,
    1.273966989243803569282078974450871097837603645553309364674069202596822090977889913363795092876747760,
    -0.636983494621901784641039487225435548918801822776654682337034601298411045488944956681897546438373871 +
    1.103287776267910592404414808764092976528379922937855445400071134013121572428383162131545363935886701*I ,
    -1.273966989243803569282078974450871097837603645553309364674069202596822090977889913363795092876747756]
])

P = magma.Matrix(CC, [
    [0.7083964215557102388915848572327136182620753648713470938161797537439929464554891349596698649565383625,
    1.001823826900653755854008522457397512910223849373963211634718240088065973837098434526606778344173978,
    0.8551101242281819973727966898450555655861496071226551527254489969160294601462937847431383216503561690 +
    0.254115587195274860061798254321272925189309646777295451676397176792772660115416432823815311439019456*I ,
    -0.2934274053449435169624236652246838946481484845026161178185384863440730273816092995669369133876356116,
    -0.5009119134503268779270042612286987564551119246869816058173591200440329869185492172633033891720869940 +
    0.359373709821960516822938109557397370330119304943460147427792486645242774558869831428432433126956505*I ,
    -0.5616827188832384804103730246203716709380011226200390349069105105719564327646844851762014082627205542 +
    0.254115587195274860061798254321272925189309646777295451676397176792772660115416432823815311439019456*I],
    [0.4149690162107667219291611920080297236139268803687309759976412673999199190738798353927329515689027612,
    -0.586854810689887033924847330449367789296296969005232235637076972688146054763218599133873826775271208,
    -0.0859428972395601559978430692206690328411850443182506298197178526441130678446693818705704376031842258 +
    0.8676048842125102369465346181999432207087385984980510507805868402307880947897026970760630560049954160*I ,
    1.001823826900653755854008522457397512910223849373963211634718240088065973837098434526606778344173976,
    0.293427405344943516962423665224683894648148484502616117818538486344073027381609299566936913387635600 -
    1.226978594034470753769472727757340591038857903441511198208379326876030869348572528504495489131951911*I ,
    -0.9158809296610935998561654532367284800690388050557125818150003874439529059924290526560363407409897472 +
    0.8676048842125102369465346181999432207087385984980510507805868402307880947897026970760630560049954140*I],
    [- 0.4293288355636027623516814049074150331258684748735280750320383948407585267488579654991165671490922123*I ,
    0,
    -0.371809678175271945183685693785863672027502235512748441141408771261966564637103093410985594353169677 -
    0.2146644177818013811758407024537075165629342374367640375160191974203792633744289827495582835745461097*I ,
    0.743619356350543890367371387571727344055004471025496882282817542523933129274206186821971188706339351,
    0.4293288355636027623516814049074150331258684748735280750320383948407585267488579654991165671490922097*I ,
    -0.371809678175271945183685693785863672027502235512748441141408771261966564637103093410985594353169677 -
    0.2146644177818013811758407024537075165629342374367640375160191974203792633744289827495582835745461077*I]
])


F = QQ
R.<x> = PolynomialRing(F)

f = -x^5
h = x^3 + x + 1
X = mHyperellipticCurve(f, h)

P = magma.Transpose(P)
Endo = EndomorphismData(X, prec = prec, have_oldenburg = True, periods = P)

print "Field of definition:"
print Endo.endomorphism_field()

print "Geometric representation:"
print Endo.geometric().representation()
