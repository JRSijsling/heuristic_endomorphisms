load "Initialize.m";
load "heuristic/Isogeny.m";

prec0 := 100;
CC<I> := ComplexField(prec0);
R<x> := PolynomialRing(CC);

// Needs higher precision: precision 30 hidden

PC := Transpose(Matrix(CC, [[-0.03561373624960805946924473887929765869962852701809315530299581441586096349740682179687291573742726550
+ 0.3376281070229429610176156213887952533914869911378152686896543583173670556843423530970619479536338201*I,
0.4407228233463559445766974528161658167222502637134237062489815193131278141544936597178873025027957326,
0.4763365595959640040459421916954634754218787907315168615519773337289887776519004815147602182402230007
- 0.1063760647734228757681611937810902979726544673617730443820272930086976722365226110157970035346570289*I,
-0.4763365595959640040459421916954634754218787907315168615519773337289887776519004815147602182402230107
- 0.3376281070229429610176156213887952533914869911378152686896543583173670556843423530970619479536338221*I],
[-0.4915050290768204867376624815978085401414157037094348573651237432402653768652730009619212234834820741
+ 0.0716344998494715009664873323629438999868784823801569609963705836265119727606681696741280438016582481*I ,
-0.4724800732530774976886480117476127831022990773207383477169017867664562911056786187553706061131208771 ,
0.01902495582374298904901446985019575703911662638869650964822195647380908575959438220655061737036119009
- 0.6903403577629439593817837148252027097453965492381684260794604927548208029941137734549680106004548054*I ,
-0.01902495582374298904901446985019575703911662638869650964822195647380908575959438220655061737036119019
- 0.07163449984947150096648733236294389998687848238015696099637058362651197276066816967412804380165824864*I]]));

PE := Transpose(Matrix(CC, [[-0.071227472499216118938489477758595317399257054036186310605991628831721926994813643593745831474854544
+0.675256214045885922035231242777590506782973982275630537379308716634734111368684706194123895907267652*I,
0.1*10^(-97) +1.350512428091771844070462485555181013565947964551261074758617433269468222737369412388247791814535290*I ,
-0.071227472499216118938489477758595317399257054036186310605991628831721926994813643593745831474854544
- 1.563264557638617595606784873117361609511256899274807163522672019286863567210414634419841798883849368*I ,
-0.369495350847139825638207975057570499322993209677237395642989890481405887159680016124141471027941182
- 0.906508256295406007284685670385295462201806506051672761686935781943403494816504448275388840326244432*I],
[0.983010058153640973475324963195617080282831407418869714730247486480530753730546001923842446966964120
- 0.1432689996989430019329746647258877999737569647603139219927411672530239455213363393482560876033165042*I ,
-0.100*10^(-97)
- 0.2865379993978860038659493294517755999475139295206278439854823345060478910426726786965121752066330042*I ,
0.983010058153640973475324963195617080282831407418869714730247486480530753730546001923842446966964120
+ 1.667218714923773922629516759102181019438307027996964696144403320015689497030900225606448196407542614*I ,
-1.455490131406718471163972974943229863385130484739608062447149273246987044836224620679213053080084992
- 0.475436858214529456482321717736371009784761102097697543090348741875284884712109264432583879195480051*I]]));

JC := ComplexStructure(PC);
JE := ComplexStructure(PE);

print JC;

RR := RealField(CC);
M := Matrix(RR, [[2, 2, 0,-3],[0,-2, 2, 0],[0, 0, 2,-1], [0,-2, 4, 0]]);

print "Small?";
//print M*JC - JE*M;
print M*JE - JC*M;
print "Small?";
print JE*M - M*JC;
M := Transpose(M);
print "Small?";
print M*JE - JC*M;
print "Small?";
print JE*M - M*JC;

exit;
