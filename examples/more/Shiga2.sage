"""
 *  Treating genus 3 curves by cheating
 *
 *  Copyright (C) 2016  J.R. Sijsling (sijsling@gmail.com)
 *
 *  Distributed under the terms of the GNU General License (GPL)
 *                  http://www.gnu.org/licenses/
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License along
 *  with this program; if not, write to the Free Software Foundation, Inc., 51
 *  Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
"""

# Add if no initilization script set:
load('Initialize.sage')

# To obtain the following matrices, use this Maple code:
#Digits := 100:
#with(algcurves):
#f := y^3 - x^4 - x^2 - 1:
#f := y^3 - 3*x^4 - 2*x^2 + 5:
#f := y^3 - 2*x^4 - 3*x^2 - 7:
#pm := periodmatrix(f,x,y):
#evalf(pm, 100);

prec = 100
CC = magma.ComplexField(prec)
I = CC.1

P = magma.Matrix([
    [1.134803188672312495958997095518625121773662233708117045195687474471598448204389367801693974966143368 +
    0.655178926457205294613395448383109293820699555666687171973623387273581675781031842354884854550813697*I ,
    1.443035550619606019725504093506357954719691587853018502632683227023212735171150749674848294985999088,
    1.856320963982115505821749142271804099133508027634626296512029087983204815789964742639118122459142907 +
    0.594526518943438762880598076969222413388186637007333140499906336219622825272632576680173553558894955*I ,
    -1.443035550619606019725504093506357954719691587853018502632683227023212735171150749674848294985999078,
    -0.721517775309803009862752046753178977359845793926509251316341613511606367585575374837424147492999544 +
    0.060652407513766531732797371413886880432512918659354031473717051053958850508399265674711300991918745*I ,
    -0.413285413362509486096245048765446144413816439781607793879345860959992080618813992964269827473143829 +
    0.5945265189434387628805980769692224133881866370073331404999063362196228252726325766801735535588949550*I],
    [0.682319183976174766324958975409193568786879222162546696709634338430359490641519124284164506267360778 -
    0.393937164541890287829467884162914242862166776378667309925264812857841626510252321453473129270790009*I ,
    -1.133386679254062992090179826170562559719344135648094849153688120753667339237093083106513452386485462,
    0.115625844349143270279869062323912288927207154338499272132790278053525821022972582730907780074118047 +
    1.375478821086794242875838812347729067491252804872217620264038334810437083354594246707149689540001727*I ,
    1.133386679254062992090179826170562559719344135648094849153688120753667339237093083106513452386485462,
    0.566693339627031496045089913085281279859672067824047424576844060376833669618546541553256726193242733 -
    1.769415985628684530705306696510643310353419581250884930189303147668278709864846568160622818810791736*I ,
    -1.249012523603206262370048888494474848646551289986594121286478398807193160260065665837421232460603510 +
    1.375478821086794242875838812347729067491252804872217620264038334810437083354594246707149689540001727*I],
    [0.636983494621901784641039487225435548918801822776654682337034601298411045488944956681897546438373876 -
    1.103287776267910592404414808764092976528379922937855445400071134013121572428383162131545363935886701*I ,
    1.273966989243803569282078974450871097837603645553309364674069202596822090977889913363795092876747742,
    0,
    1.273966989243803569282078974450871097837603645553309364674069202596822090977889913363795092876747760,
    -0.636983494621901784641039487225435548918801822776654682337034601298411045488944956681897546438373871 +
    1.103287776267910592404414808764092976528379922937855445400071134013121572428383162131545363935886701*I ,
    -1.273966989243803569282078974450871097837603645553309364674069202596822090977889913363795092876747756]
])

P = magma.Matrix([
    [0.3596159620758356536660049977404867887369301100593537786884791071335461276084493654463922346684666390 +
    0.343563140948777788480542697055306391620026148465963468899045590689675543151291737878907248789626802*I ,
    0.5950688157312305839801285639716368841716631333870687251330044735076772154846732174482597915197377080 +
    0.343563140948777788480542697055306391620026148465963468899045590689675543151291737878907248789626801*I ,
    0.4773423889035331188230667808560618364542966217232112519107417903206116715465612914473260130941021720 +
    0.547471293607889524028083424779836065943609274763851564989372691404522591620883123003583793959813535*I ,
    -0.235452853655394930314123566231150095434733023327714946444525366374131087876223852001867556851271064,
    -0.595068815731230583980128563971636884171663133387068725133004473507677215484673217448259791519737704 -
    0.064253164369445682614538758393752957027140104129812723281608610740018553787891032370445841550746689*I ,
    -0.2418895352481381885089432146249117410195635983954963054662164239464805836703374394454584562428311090 -
    0.139654988289666052933001969330776717296443022168075372808718489974828494681700352754230703619440060*I],
    [0.482778480811134185083659520507167194653736512226247761497640276126846621100557938502820017690657473 +
    0.406972827761173276156188510842412165564810714230889462687160541001695323544333180671731137011357962*I ,
    -0.704897614982329777029148001187332580475396093589108695173092617281479154830767241122635281163529973 +
    0.406972827761173276156188510842412165564810714230889462687160541001695323544333180671731137011357960*I ,
    -0.111059567085597795972744240340082692910829790681430466837726170577316266865104651309907631736436259 +
    1.435530498185833538088756296075740876973576186991355352239650648751560424138568397520521985657651122*I ,
    1.187676095793463962112807521694499775129132605815356456670732893408325775931325179625455298854187459,
    0.704897614982329777029148001187332580475396093589108695173092617281479154830767241122635281163529974 -
    1.650142513088147247708947059624245257252720231290042316417819674498034877644137253025850560281228377*I ,
    -1.076616528707866166140063281354417082218302815133925989833006722831009509066220528315547667117751203 +
    0.621584842663486985776379274390916545843954758529576426865329566748169777049902036177059711634935202*I],
    [- 0.5304054404159367224104895114788340720170935203460910205123743068972747396895119408071722674386557195*I ,
    0,
    -0.4593445857056746135640373146941594119283854329946955531552303069378209950054969329744672091606472850 -
    0.2652027202079683612052447557394170360085467601730455102561871534486373698447559704035861337193278645*I ,
    0.918689171411349227128074629388318823856770865989391106310460613875641990010993865948934418321294566,
    0.5304054404159367224104895114788340720170935203460910205123743068972747396895119408071722674386557230*I ,
    -0.4593445857056746135640373146941594119283854329946955531552303069378209950054969329744672091606472800 -
    0.2652027202079683612052447557394170360085467601730455102561871534486373698447559704035861337193278649*I]
])

P = magma.Matrix([
    [0.4190120711876836672790778302800907408294979885648861480375244257784963286415379988162877591591845890 +
    0.2419167320939117991280084712430721927047143564411104471269151296599724763418036285328711353291706630*I ,
    0.5216505926828409139380338896537866032829051349021677099302052165034700335861151793858166287497181278,
    0.6798373675291041242480947751069840424709505560159700030026270340302313454345955885091960735340436470 +
    0.2098459330686372395576875237038473869401603107033854667454516367997204697365136653221820160889825404*I ,
    -0.521650592682840913938033889653786603282905134902167709930205216503470033586115179385816628749718125,
    -0.2608252963414204569690169448268933016414525674510838549651026082517350167930575896929083143748590589 +
    0.0320707990252745595703209475392248057645540457377249803814634928602520066052899632106891192401881126*I ,
    -0.1581867748462632103100608854531974391880454211138022930724218175267613118484804091233794447843255290 +
    0.2098459330686372395576875237038473869401603107033854667454516367997204697365136653221820160889825384*I],
    [0.509035945212913559812577390633247084995362216409835550284897576758038649400418854715536787704868038 -
    0.293892039995871236305175053247659136489771061984013249510756666841683614609401349467590886722987227*I ,
    -0.779737110315524090488933981431730538196027006279827631390178582991355089094361454891299426306603762,
    0.119167390055151514568110399917381815897348713269921734589808285262361104853238127269887074551566150 +
    0.969164185802584367574428220124892985747654354570974377645093281633771402154269092686163758938623585*I ,
    0.779737110315524090488933981431730538196027006279827631390178582991355089094361454891299426306603761,
    0.389868555157762045244466990715865269098013503139913815695089291495677544547180727445649713153301882 -
    1.263056225798455603879603273372552122237425416554987627155849948475455016763670442153754645661610818*I ,
    -0.898904500370675605057044381349112354093375719549749365979986868253716193947599582161186500858169919 +
    0.969164185802584367574428220124892985747654354570974377645093281633771402154269092686163758938623581*I],
    [0.319611266483937562031973917276683689593974554833939850823786424500494443204369143080051515888087925 -
    0.553582952221615699113354804702811438595989223785519645822100143476944545152544811118776327311592204*I ,
    0.639222532967875124063947834553367379187949109667879701647572849000988886408738286160103031776175848,
    0,
    0.639222532967875124063947834553367379187949109667879701647572849000988886408738286160103031776175854,
    -0.319611266483937562031973917276683689593974554833939850823786424500494443204369143080051515888087922 +
    0.553582952221615699113354804702811438595989223785519645822100143476944545152544811118776327311592208*I ,
    -0.639222532967875124063947834553367379187949109667879701647572849000988886408738286160103031776175853]
])

P = magma.Transpose(P)
g = 0
End = EndomorphismData(g, prec = prec)
End._P_ = P

AsAlg, As, Rs = End.geometric_representations()
print AsAlg
print Rs
print magma.SplittingInfoOneOff(AsAlg, As, Rs)

K = magma.BaseRing(AsAlg[1])
G = magma.GaloisGroup(K)
print K
print G
print magma.IsCyclic(G)

idem = (AsAlg[2] + 1)/2
idem = magma.Matrix(magma.BaseRing(P), 3, 3, magma.Eltseq(idem))
Q = magma.LatticesFromIdempotentG2(idem, P)
print Q

# Analyze factor:
#Q = magma.Matrix(magma.BaseRing(P), 4, 2, Q) 
#g = 0
#End = EndomorphismData(g, prec = prec)
#End._P_ = Q
#
#AsAlg, As, Rs = End.geometric_representations()
#print AsAlg
#print Rs
#print magma.SplittingInfoOneOff(AsAlg, As, Rs)
#
#K = magma.BaseRing(AsAlg[1])
#G = magma.GaloisGroup(K)
#print K
#print G
#print magma.IsCyclic(G)

